<!DOCTYPE html>
<html>
<head>
    <title>API Test</title>
</head>
<body>
    <h1>Training Monitor API Test</h1>
    <button onclick="testApis()">Test All APIs</button>
    <pre id="output" style="background: #000; color: #0f0; padding: 20px; margin-top: 20px;"></pre>

    <script>
        async function testApis() {
            const output = document.getElementById('output');
            output.textContent = 'Testing APIs...\n\n';

            try {
                // Test training status
                const status = await fetch('/status/training_status.json').then(r => r.json());
                output.textContent += '‚úÖ Training Status API:\n';
                output.textContent += `   Status: ${status.status}\n`;
                output.textContent += `   Step: ${status.current_step}/${status.total_steps}\n`;
                output.textContent += `   Loss: ${status.loss}\n\n`;

                // Test GPU stats
                const gpu = await fetch('/api/gpu_stats').then(r => r.json());
                output.textContent += '‚úÖ GPU Stats API:\n';
                output.textContent += `   Temp: ${gpu.temperature}¬∞C\n`;
                output.textContent += `   Util: ${gpu.gpu_utilization}%\n\n`;

                // Test memory stats
                const mem = await fetch('http://localhost:8081/api/memory_stats').then(r => r.json());
                output.textContent += '‚úÖ Memory Stats API:\n';
                output.textContent += `   Used: ${mem.used_gb.toFixed(1)} GB\n`;
                output.textContent += `   Percent: ${mem.percent}%\n\n`;

                // Test inbox files
                const inbox = await fetch('/api/inbox_files').then(r => r.json());
                output.textContent += '‚úÖ Inbox Files API:\n';
                output.textContent += `   Files: ${inbox.count}\n\n`;

                // Test queue samples
                const samples = await fetch('/api/inbox_samples').then(r => r.json());
                output.textContent += '‚úÖ Queue Samples API:\n';
                output.textContent += `   Samples: ${samples.samples?.length || 0}\n\n`;

                output.textContent += 'üéâ All APIs working!\n';
            } catch (e) {
                output.textContent += `\n‚ùå ERROR: ${e.message}\n`;
                console.error(e);
            }
        }

        // Auto-test on load
        testApis();
    </script>
</body>
</html>
